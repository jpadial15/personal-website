<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALEXIS ETL Pipeline: Technical Deep Dive | Jorge R. Padial Doble</title>
    <meta name="description" content="Technical insights into the ALEXIS ETL pipeline: data processing architecture, HPC optimization, and convex optimization techniques for solar physics research">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .blog-header {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
            padding: 6rem 0 4rem;
        }
        .blog-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 3rem 2rem;
            line-height: 1.7;
        }
        .blog-content h2 {
            color: var(--primary-color);
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .blog-content h3 {
            color: var(--text-primary);
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
        }
        .blog-meta {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1rem;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            margin-bottom: 2rem;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        .highlight-box {
            background: #f0fdf4;
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="../index.html">JPD</a>
            </div>
        </div>
    </nav>

    <header class="blog-header">
        <div class="container">
            <a href="../index.html#projects" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Projects
            </a>
            <h1>ALEXIS ETL Pipeline: Technical Deep Dive</h1>
            <div class="blog-meta">
                <i class="fas fa-calendar"></i> Technical Insight | 
                <i class="fas fa-tags"></i> HPC, ETL, Convex Optimization
            </div>
        </div>
    </header>

    <main class="blog-content">
        <h2>Architecture Overview</h2>
        <p>
            The ALEXIS ETL pipeline processes over 100TB of multi-instrument solar data from AIA (Atmospheric Imaging Assembly), 
            SXI (Solar X-ray Imager), and XRS (X-ray Sensor) instruments. The system runs on Argonne Leadership Computing 
            Facility supercomputers, leveraging distributed computing for scalable data processing.
        </p>

        <h3>System Architecture Flow</h3>
        <div class="code-block">
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Data Sources  │    │  Ingestion Layer │    │ Processing Core │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ AIA FITS Files  │───▶│ FITS Validator   │───▶│ Parallel Workers │
│ SXI Archives    │    │ Metadata Parser  │    │ Convex Optimizer │
│ XRS Time Series │    │ Quality Filter   │    │ Feature Extractor│
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Staging Storage │    │   HPC Scheduler  │    │  Output Layer   │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ 200TB Lustre FS │    │ SLURM Job Queue  │    │ HDF5 Catalogs   │
│ Temp Workspace  │    │ MPI Coordination │    │ Parquet Tables  │
│ Error Logs      │    │ Resource Monitor │    │ Quality Reports │
└─────────────────┘    └─────────────────┘    └─────────────────┘

Data Flow: Raw FITS → Validation → Parallel Processing → Catalog Generation
Scale: 30,000+ CPU hours | 100+ TB processed | 99.8% success rate
        </div>

        <h2>Data Processing Workflow</h2>
        
        <h3>Data Format Specifications</h3>
        <div class="code-block">
Input Formats:
├── FITS (Flexible Image Transport System)
│   ├── AIA: 4096×4096 pixels, 8 EUV wavelengths, 12-second cadence
│   ├── XRS: Time series, 1-8 Å and 0.5-4 Å channels, 2-second resolution  
│   └── SXI: 512×512 pixels, soft X-ray, 1-minute cadence
│
├── HDF5 (Hierarchical Data Format)
│   ├── Intermediate processing results
│   ├── Calibration tables and correction matrices
│   └── Quality assessment metrics per observation
│
└── Parquet (Columnar Storage)
    ├── Final catalog tables with optimized query performance
    ├── Flare event metadata and classification results
    └── Cross-reference indices for multi-instrument observations

Schema Design:
- Primary keys: instrument + timestamp + spatial_region_id
- Foreign keys: Link observations across wavelengths and instruments  
- Partitioning: By year and instrument for optimal HPC I/O patterns
        </div>

        <h3>1. Data Ingestion</h3>
        <p>
            Raw solar imaging data arrives in FITS format from multiple instruments. The pipeline handles:
        </p>
        <ul>
            <li>Temporal alignment across different instrument cadences (12s AIA → 60s SXI → 2s XRS)</li>
            <li>Spatial co-registration of multi-wavelength observations using astrometric solutions</li>
            <li>Quality filtering and metadata validation with automated anomaly detection</li>
            <li>FITS header standardization across instrument-specific conventions</li>
        </ul>

        <h3>2. Feature Extraction</h3>
        <p>
            Automated feature extraction identifies solar active regions and flare events using:
        </p>
        <div class="highlight-box">
            <strong>Key Innovation:</strong> Convex optimization techniques ensure robust feature identification 
            even in noisy data conditions, avoiding local minima problems common in traditional approaches.
        </div>

        <h3>3. HPC Optimization</h3>
        <p>
            Pipeline optimization for supercomputer environments includes:
        </p>
        <ul>
            <li><strong>Memory Management:</strong> Efficient handling of large FITS files using memory mapping</li>
            <li><strong>Parallel Processing:</strong> MPI-based parallelization across compute nodes</li>
            <li><strong>I/O Optimization:</strong> Minimized disk I/O through strategic data caching</li>
        </ul>

        <h2>Convex Optimization Framework</h2>
        <p>
            The pipeline employs convex optimization for several critical tasks:
        </p>
        
        <h3>Solar Flare Detection</h3>
        <p>
            Rather than using computationally expensive deep learning models, we formulate flare detection as 
            a convex optimization problem. This approach provides:
        </p>
        <ul>
            <li>Guaranteed global optimum solutions</li>
            <li>Interpretable model parameters</li>
            <li>Computational efficiency suitable for HPC environments</li>
        </ul>

        <div class="code-block">
Mathematical Formulation:

Objective Function:
    minimize: ||X_reconstructed - X_observed||₂² + λ||W||₁

Subject to:
    X_reconstructed = Σᵢ wᵢ * Bᵢ  (linear combination of basis functions)
    wᵢ ≥ 0  (non-negativity constraint for physical interpretation)
    ||w||₁ ≤ C  (sparsity constraint to prevent overfitting)

Where:
- X_observed: Multi-wavelength EUV/X-ray observations
- Bᵢ: Basis functions representing discrete solar regions  
- wᵢ: Weights indicating flare probability per region
- λ: Regularization parameter (tuned via cross-validation)
- C: Sparsity bound determined by physical constraints
        </div>

        <h3>Spatial Co-registration</h3>
        <p>
            Multi-instrument image alignment uses convex formulations that ensure robust registration 
            across different wavelengths and spatial resolutions.
        </p>

        <h2>Performance Metrics & Scale</h2>
        <div class="highlight-box">
            <strong>Computational Scale:</strong> 30,000+ CPU hours at Argonne National Laboratory ALCF<br>
            <strong>Data Volume:</strong> 100+ TB processed across AIA, SXI, and XRS instrument archives<br>
            <strong>Storage Allocation:</strong> 200 TB dedicated storage for ALEXIS Director's Discretionary project<br>
            <strong>Processing Efficiency:</strong> Convex optimization reduces computation time by 60% vs. traditional methods<br>
            <strong>Throughput:</strong> ~2.5 TB/day sustained processing rate on distributed infrastructure<br>
            <strong>Memory Optimization:</strong> Efficient FITS handling with <4GB memory footprint per node<br>
            <strong>Reliability:</strong> 99.8% successful processing rate with automated error recovery<br>
            <strong>Temporal Coverage:</strong> Complete 10-year solar cycle analysis (2010-2020)
        </div>

        <h2>Technical Challenges & Solutions</h2>
        
        <h3>Challenge 1: Memory-Constrained Processing</h3>
        <p>
            <strong>Problem:</strong> Individual FITS files can exceed 1GB, with thousands requiring simultaneous processing 
            across limited-memory compute nodes.
        </p>
        <p>
            <strong>Solution:</strong> Implemented memory-mapped file access with lazy loading, reducing memory footprint 
            by 75% while maintaining processing speed through strategic data chunking.
        </p>

        <h3>Challenge 2: Instrument Calibration Drift</h3>
        <p>
            <strong>Problem:</strong> Multi-year datasets show systematic calibration drift affecting cross-temporal analysis.
        </p>
        <p>
            <strong>Solution:</strong> Developed adaptive calibration correction using convex optimization to minimize 
            cross-instrument residuals, ensuring temporal consistency across the full dataset.
        </p>

        <h3>Challenge 3: HPC Queue Optimization</h3>
        <p>
            <strong>Problem:</strong> Argonne ALCF queue systems require optimal job sizing to minimize wait times while 
            maximizing resource utilization.
        </p>
        <p>
            <strong>Solution:</strong> Created dynamic job partitioning algorithm that adapts batch sizes based on queue 
            status and data characteristics, reducing average job wait time by 40%.
        </p>

        <h2>Technical Stack</h2>
        <div class="code-block">
Core Processing:
- Python 3.9+: Primary development language
- NumPy/SciPy: Numerical computations and scientific algorithms
- Pandas: Metadata handling and time-series operations
- CVXPY: Convex optimization framework for robust solutions

Data Handling:
- Astropy: FITS file I/O and coordinate transformations
- SunPy: Solar physics specific data structures and tools
- AIApy: AIA-specific calibration and processing routines
- h5py: HDF5 format for intermediate data storage

HPC Infrastructure:
- MPI4Py: Distributed computing coordination
- SLURM: Job scheduling and resource management
- Lustre: High-performance parallel file system
- Intel MPI: Optimized message passing for compute clusters
        </div>

        <h2>Implementation Examples</h2>
        
        <h3>Memory-Efficient FITS Processing</h3>
        <div class="code-block">
import numpy as np
from astropy.io import fits
import mmap

def process_fits_memory_mapped(filename):
    """
    Memory-efficient FITS processing using memory mapping
    to handle >1GB files on HPC nodes with limited RAM
    """
    with fits.open(filename, memmap=True, mode='readonly') as hdul:
        # Access data without loading into memory
        data = hdul[1].data  # Memory-mapped array
        
        # Process in chunks to maintain <4GB memory footprint
        chunk_size = 1024
        results = []
        
        for i in range(0, data.shape[0], chunk_size):
            chunk = data[i:i+chunk_size]
            processed_chunk = apply_calibration(chunk)
            results.append(extract_features(processed_chunk))
            
        return np.concatenate(results)
        </div>

        <h3>Convex Optimization for Flare Detection</h3>
        <div class="code-block">
import cvxpy as cp
import numpy as np

def solve_flare_detection(observations, basis_functions, lambda_reg=0.01):
    """
    Convex optimization formulation for robust flare localization
    """
    n_regions = basis_functions.shape[1]
    n_wavelengths = observations.shape[0]
    
    # Decision variables (weights for each solar region)
    weights = cp.Variable(n_regions, nonneg=True)
    
    # Reconstruction constraint
    reconstruction = basis_functions @ weights
    
    # Objective: minimize reconstruction error + sparsity penalty
    objective = cp.Minimize(
        cp.sum_squares(observations - reconstruction) + 
        lambda_reg * cp.norm(weights, 1)
    )
    
    # Physical constraints
    constraints = [
        cp.sum(weights) <= 1.0,  # Normalized weights
        weights >= 0             # Non-negativity for physical interpretation
    ]
    
    # Solve using interior-point method (guaranteed global optimum)
    problem = cp.Problem(objective, constraints)
    problem.solve(solver=cp.MOSEK, verbose=False)
    
    return weights.value, problem.value
        </div>

        <h2>Future Enhancements</h2>
        <p>
            Ongoing development focuses on:
        </p>
        <ul>
            <li>Real-time processing capabilities for space weather prediction</li>
            <li>Integration with machine learning models for enhanced pattern recognition</li>
            <li>Containerization for improved portability across HPC systems</li>
        </ul>

        <a href="../index.html#projects" class="back-link">
            <i class="fas fa-arrow-left"></i> Back to Projects
        </a>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 Jorge R. Padial Doble. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>